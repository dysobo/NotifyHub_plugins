# 用药提醒插件使用说明

## 📋 功能简介

用药提醒插件可以帮您定时发送用药提醒，支持：
- ✅ 最多10个用药时间段
- ✅ 每个时间段最多10种药品
- ✅ 每个药品可指定不同发送渠道
- ✅ 支持药品图片
- ✅ 自定义时间段名称

## 🚀 快速开始

### 1. 基本配置
1. **默认发送渠道**：选择主要通知渠道（如微信）
2. **标题前缀**：设置提醒标题前缀（默认：`[用药提醒]`）

### 2. 设置用药时间
- **用药时间1**：填写时间，如 `08:00`
- **用药时间1名称**：自定义名称，如 `上午用药`
- **用药时间1-药品1**：填写药品信息

### 3. 药品格式
```
药品名称 - 用量 [图片URL] [渠道名称]
```

**示例：**
```
维生素C - 1片 [https://example.com/vitamin-c.jpg] [微信]
钙片 - 2片 [钉钉]
叶酸 - 1粒
```

**说明：**
- `图片URL` 和 `渠道名称` 都是可选的
- 不填写渠道名称则使用默认渠道
- 不填写图片URL则不显示图片

## 📱 消息发送方式

1. **第一条消息**：发送药品清单到第一个药品的渠道
2. **等待30秒**
3. **后续消息**：依次发送每个药品到指定渠道

## 🎯 配置示例

### 简单配置
```
默认发送渠道：微信
用药时间1：08:00
用药时间1名称：上午用药
用药时间1-药品1：维生素C - 1片
用药时间1-药品2：钙片 - 2片
```

### 复杂配置（多渠道）
```
默认发送渠道：微信
用药时间1：08:00
用药时间1名称：上午用药
用药时间1-药品1：维生素C - 1片 [https://example.com/vitamin-c.jpg] [微信]
用药时间1-药品2：钙片 - 2片 [钉钉]
用药时间1-药品3：叶酸 - 1粒

用药时间3：20:00
用药时间3名称：晚上用药
用药时间3-药品1：维生素D - 1粒 [微信]
用药时间3-药品2：鱼油 - 2粒 [钉钉]
```

## ⚙️ 高级功能

### 1. 提醒计划类型
- **每日固定时间**：每天固定时间提醒
- **每周特定时间**：每周特定星期和时间
- **每月特定时间**：每月特定日期和时间
- **每年特定时间**：每年特定月日和时间
- **高级 Cron 表达式**：使用标准 cron 语法

### 2. 优先级说明
1. **用药时间段配置**（最高优先级）
2. 每日提醒时间
3. 传统药品配置

## 🔧 API 接口

- **健康检查**：`GET /api/plugins/pill_reminder/ping`
- **状态查询**：`GET /api/plugins/pill_reminder/status`
- **手动触发**：`POST /api/plugins/pill_reminder/trigger`

## ❓ 常见问题

### Q: 为什么有些药品发送到不同渠道？
A: 每个药品可以指定不同的渠道，如果药品没有指定渠道，则使用默认渠道。

### Q: 为什么消息有30秒间隔？
A: 为了避免消息过于频繁，系统先发送清单，30秒后依次发送每个药品。

### Q: 如何查看当前配置状态？
A: 访问 `/api/plugins/pill_reminder/status` 可以查看当前使用的配置类型和药品信息。

### Q: 最多可以设置多少个用药时间？
A: 最多可以设置10个用药时间段，每个时间段最多10种药品。

## 📞 技术支持

如有问题，请检查：
1. 配置是否正确保存
2. 渠道是否正常配置
3. 时间格式是否正确（HH:MM）
4. 药品格式是否正确

---

**版本**：0.0.1  
**作者**：dysobo